
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="lenskit.flexmf" />
<meta property="og:type" content="website" />
<meta property="og:url" content="api/lenskit.flexmf.html" />
<meta property="og:site_name" content="LensKit" />
<meta property="og:description" content="Flexible PyTorch matrix factorization models for LensKit. The components in this package implement several matrix factorization models for LensKit, and also serve as an example for practical PyTorc..." />
<meta name="description" content="Flexible PyTorch matrix factorization models for LensKit. The components in this package implement several matrix factorization models for LensKit, and also serve as an example for practical PyTorc..." />

    <title>lenskit.flexmf &#8212; LensKit 2025.3.0a4.dev355+gf6e086e0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=9d9b0268" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=225a3d0d"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api/lenskit.flexmf';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://lkpy.lenskit.org/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = '2024.0dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            true;
        </script>
    <link rel="canonical" href="https://lkpy.lenskit.org/latest/api/lenskit.flexmf.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="lenskit.sklearn" href="lenskit.sklearn.html" />
    <link rel="prev" title="lenskit.als" href="lenskit.als.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="2025.3.0" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/LKLogo2.png" class="logo__image only-light" alt="LensKit 2025.3.0a4.dev355+gf6e086e0 documentation - Home"/>
    <img src="../_static/LKLogo2.png" class="logo__image only-dark pst-js-only" alt="LensKit 2025.3.0a4.dev355+gf6e086e0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../releases/index.html">
    Release Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../research/index.html">
    Research
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../catalogs.html">
    Indices
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/lenskit/lkpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://recsys.social/@LensKit" title="Mastodon" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Mastodon</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/lenskit.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../releases/index.html">
    Release Notes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../research/index.html">
    Research
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../catalogs.html">
    Indices
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/lenskit/lkpy" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://recsys.social/@LensKit" title="Mastodon" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-mastodon fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Mastodon</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://bsky.app/profile/lenskit.org" title="BlueSky" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-bluesky fa-lg" aria-hidden="true"></i>
            <span class="sr-only">BlueSky</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><p aria-level="2" class="caption" role="heading"><span class="caption-text">Core</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="data.html">Data Abstractions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="data-types.html">Basic Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.Dataset.html">lenskit.data.Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.EntitySet.html">lenskit.data.EntitySet</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.AttributeSet.html">lenskit.data.AttributeSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.RelationshipSet.html">lenskit.data.RelationshipSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.MatrixRelationshipSet.html">lenskit.data.MatrixRelationshipSet</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.CSRStructure.html">lenskit.data.CSRStructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.DatasetBuilder.html">lenskit.data.DatasetBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.from_interactions_df.html">lenskit.data.from_interactions_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.load_movielens.html">lenskit.data.load_movielens</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.load_movielens_df.html">lenskit.data.load_movielens_df</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.ItemList.html">lenskit.data.ItemList</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.ItemListCollection.html">lenskit.data.ItemListCollection</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.ItemListCollector.html">lenskit.data.ItemListCollector</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.ListILC.html">lenskit.data.ListILC</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.UserIDKey.html">lenskit.data.UserIDKey</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.GenericKey.html">lenskit.data.GenericKey</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.MutableItemListCollection.html">lenskit.data.MutableItemListCollection</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.RecQuery.html">lenskit.data.RecQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.QueryInput.html">lenskit.data.QueryInput</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.schema.html">lenskit.data.schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.Vocabulary.html">lenskit.data.Vocabulary</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.matrix.SparseRowType.html">lenskit.data.matrix.SparseRowType</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.matrix.SparseIndexType.html">lenskit.data.matrix.SparseIndexType</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.data.matrix.SparseRowArray.html">lenskit.data.matrix.SparseRowArray</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="pipeline.html">Pipeline API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.Pipeline.html">lenskit.pipeline.Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.PipelineBuilder.html">lenskit.pipeline.PipelineBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.PipelineState.html">lenskit.pipeline.PipelineState</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.Node.html">lenskit.pipeline.Node</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.Lazy.html">lenskit.pipeline.Lazy</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.PipelineCache.html">lenskit.pipeline.PipelineCache</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.Component.html">lenskit.pipeline.Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.RecPipelineBuilder.html">lenskit.pipeline.RecPipelineBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.topn_pipeline.html">lenskit.pipeline.topn_pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.predict_pipeline.html">lenskit.pipeline.predict_pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.PipelineConfig.html">lenskit.pipeline.PipelineConfig</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.pipeline.ComponentInputHook.html">lenskit.pipeline.ComponentInputHook</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="diagnostics.html">Diagnostic APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="training.html">Model Training</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="state.html">Model State</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.state.ParameterContainer.html">lenskit.state.ParameterContainer</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Components</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="lenskit.basic.html">lenskit.basic</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.basic.bias.html">lenskit.basic.bias</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.basic.candidates.html">lenskit.basic.candidates</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.basic.composite.html">lenskit.basic.composite</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.basic.history.html">lenskit.basic.history</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.basic.popularity.html">lenskit.basic.popularity</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.basic.random.html">lenskit.basic.random</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.basic.topn.html">lenskit.basic.topn</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.stochastic.html">lenskit.stochastic</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lenskit.knn.html">lenskit.knn</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.knn.item.html">lenskit.knn.item</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.knn.user.html">lenskit.knn.user</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.als.html">lenskit.als</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">lenskit.flexmf</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lenskit.sklearn.html">lenskit.sklearn</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.sklearn.nmf.html">lenskit.sklearn.nmf</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.sklearn.svd.html">lenskit.sklearn.svd</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.funksvd.html">lenskit.funksvd</a></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.implicit.html">lenskit.implicit</a></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.hpf.html">lenskit.hpf</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Evaluation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="batch.html">Batch Operations</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.batch.BatchPipelineRunner.html">lenskit.batch.BatchPipelineRunner</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.batch.BatchResults.html">lenskit.batch.BatchResults</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.batch.predict.html">lenskit.batch.predict</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.batch.recommend.html">lenskit.batch.recommend</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.batch.InvocationSpec.html">lenskit.batch.InvocationSpec</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="metrics.html">Metrics and Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.Metric.html">lenskit.metrics.Metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.ListMetric.html">lenskit.metrics.ListMetric</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.GlobalMetric.html">lenskit.metrics.GlobalMetric</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.MetricFunction.html">lenskit.metrics.MetricFunction</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.RankingMetricBase.html">lenskit.metrics.RankingMetricBase</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.RunAnalysis.html">lenskit.metrics.RunAnalysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.RunAnalysisResult.html">lenskit.metrics.RunAnalysisResult</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.ListLength.html">lenskit.metrics.ListLength</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.TestItemCount.html">lenskit.metrics.TestItemCount</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.NDCG.html">lenskit.metrics.NDCG</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.RBP.html">lenskit.metrics.RBP</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.Precision.html">lenskit.metrics.Precision</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.Recall.html">lenskit.metrics.Recall</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.RecipRank.html">lenskit.metrics.RecipRank</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.MeanPopRank.html">lenskit.metrics.MeanPopRank</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.ExposureGini.html">lenskit.metrics.ExposureGini</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.ListGini.html">lenskit.metrics.ListGini</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.RMSE.html">lenskit.metrics.RMSE</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.MAE.html">lenskit.metrics.MAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.RankWeight.html">lenskit.metrics.RankWeight</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.GeometricRankWeight.html">lenskit.metrics.GeometricRankWeight</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.metrics.LogRankWeight.html">lenskit.metrics.LogRankWeight</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="splitting.html">Data Splitting</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.TTSplit.html">lenskit.splitting.TTSplit</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.split_global_time.html">lenskit.splitting.split_global_time</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.crossfold_users.html">lenskit.splitting.crossfold_users</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.sample_users.html">lenskit.splitting.sample_users</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.LastFrac.html">lenskit.splitting.LastFrac</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.LastN.html">lenskit.splitting.LastN</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.SampleFrac.html">lenskit.splitting.SampleFrac</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.SampleN.html">lenskit.splitting.SampleN</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.crossfold_records.html">lenskit.splitting.crossfold_records</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.splitting.sample_records.html">lenskit.splitting.sample_records</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Implementation Helpers</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="lenskit.logging.html">lenskit.logging</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.config.html">lenskit.logging.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.formats.html">lenskit.logging.formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.monitor.html">lenskit.logging.monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.multiprocess.html">lenskit.logging.multiprocess</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.processors.html">lenskit.logging.processors</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.progress.html">lenskit.logging.progress</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.resource.html">lenskit.logging.resource</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.stopwatch.html">lenskit.logging.stopwatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.tasks.html">lenskit.logging.tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.tracing.html">lenskit.logging.tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.logging.worker.html">lenskit.logging.worker</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lenskit.math.html">lenskit.math</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.math.solve.html">lenskit.math.solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.math.sparse.html">lenskit.math.sparse</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="lenskit.parallel.html">lenskit.parallel</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="lenskit.parallel.config.html">lenskit.parallel.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.parallel.invoker.html">lenskit.parallel.invoker</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.parallel.pool.html">lenskit.parallel.pool</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.parallel.ray.html">lenskit.parallel.ray</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.parallel.sequential.html">lenskit.parallel.sequential</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.parallel.serialize.html">lenskit.parallel.serialize</a></li>
<li class="toctree-l2"><a class="reference internal" href="lenskit.parallel.worker.html">lenskit.parallel.worker</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.random.html">lenskit.random</a></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.stats.html">lenskit.stats</a></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit.torch.html">lenskit.torch</a></li>
<li class="toctree-l1"><a class="reference internal" href="lenskit._accel.html">lenskit._accel</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">lenskit.flexmf</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-lenskit.flexmf">
<span id="lenskit-flexmf"></span><h1>lenskit.flexmf<a class="headerlink" href="#module-lenskit.flexmf" title="Link to this heading">#</a></h1>
<p>Flexible PyTorch matrix factorization models for LensKit.</p>
<p>The components in this package implement several matrix factorization models for
LensKit, and also serve as an example for practical PyTorch recommender
training.</p>
<div class="note admonition">
<p class="admonition-title">Stability: Internal</p>
<p>
This API is at the <strong>internal</strong> or <strong>experimental</strong> stability level: it may
change at any time, and breaking changes will not necessarily be described in
the release notes. See <a class="reference internal" href="../releases/index.html#stability-levels"><span class="std std-ref">Stability Levels</span></a> for details.

FlexMF is provided as a preview release, and may change in the next months
as we gain more experience with it.</p>
</div>
<blockquote>
<div><p>as we gain more experience with it.</p>
</div></blockquote>
<dl class="py class">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFConfigBase">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenskit.flexmf.</span></span><span class="sig-name descname"><span class="pre">FlexMFConfigBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'AdamW'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFConfigBase" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" rel="noreferrer" target="_blank" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Common configuration for all FlexMF scoring components.</p>
<dl class="field-list simple">
<dt class="field-odd">Stability<span class="colon">:</span></dt>
<dd class="field-odd"><p>Experimental</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>embedding_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>regularization</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>reg_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'AdamW'</em><em>, </em><em>'L2'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFConfigBase.batch_size">
<span class="sig-name descname"><span class="pre">batch_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">8192</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFConfigBase.batch_size" title="Link to this definition">#</a></dt>
<dd><p>The training batch size.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFConfigBase.embedding_size">
<span class="sig-name descname"><span class="pre">embedding_size</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFConfigBase.embedding_size" title="Link to this definition">#</a></dt>
<dd><p>The dimension of the embedding space (number of latent features).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFConfigBase.epochs">
<span class="sig-name descname"><span class="pre">epochs</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">int</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">10</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFConfigBase.epochs" title="Link to this definition">#</a></dt>
<dd><p>The number of training epochs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFConfigBase.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFConfigBase.learning_rate" title="Link to this definition">#</a></dt>
<dd><p>The learning rate for training.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFConfigBase.reg_method">
<span class="sig-name descname"><span class="pre">reg_method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'AdamW'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'L2'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'AdamW'</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFConfigBase.reg_method" title="Link to this definition">#</a></dt>
<dd><p>The regularization method to use.</p>
<p>With the default AdamW regularization, training will use the
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.AdamW.html#torch.optim.AdamW" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdamW</span></code></a> optimizer with weight decay. With L2
regularization, training will use sparse gradients and the
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.SparseAdam.html#torch.optim.SparseAdam" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.SparseAdam</span></code></a> optimizer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The explicit-feedback model defaults this setting to <code class="docutils literal notranslate"><span class="pre">&quot;L2&quot;</span></code>.</p>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>Use no regularization.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;L2&quot;</span></code></dt><dd><p>Use L2 regularization on the parameters used in each training batch. The
strength is applied to the _mean_ norms in a batch, so that the
regularization term scale is not dependent on the batch size.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;AdamW&quot;</span></code></dt><dd><p>Use <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.AdamW.html#torch.optim.AdamW" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.AdamW</span></code></a> with the specified regularization
strength.  This configuration does <em>not</em> use sparse gradients, but
training time is often comparable.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Regularization values do not necessarily have the same range or meaning
for the different regularization methods.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFConfigBase.regularization">
<span class="sig-name descname"><span class="pre">regularization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.01</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFConfigBase.regularization" title="Link to this definition">#</a></dt>
<dd><p>The regularization strength.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The explicit-feedback model uses a different default strength.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFScorerBase">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenskit.flexmf.</span></span><span class="sig-name descname"><span class="pre">FlexMFScorerBase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFScorerBase" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="training.html#lenskit.training.UsesTrainer" title="lenskit.training.UsesTrainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">UsesTrainer</span></code></a>, <a class="reference internal" href="lenskit.pipeline.Component.html#lenskit.pipeline.Component" title="lenskit.pipeline.components.Component"><code class="xref py py-class docutils literal notranslate"><span class="pre">Component</span></code></a></p>
<p>Base class for the FlexMF scorers, providing common Torch support.</p>
<dl class="field-list simple">
<dt class="field-odd">Stability<span class="colon">:</span></dt>
<dd class="field-odd"><p>Experimental</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#lenskit.flexmf.FlexMFConfigBase" title="lenskit.flexmf._base.FlexMFConfigBase"><em>FlexMFConfigBase</em></a>)</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFScorerBase.score_items">
<span class="sig-name descname"><span class="pre">score_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFScorerBase.score_items" title="Link to this definition">#</a></dt>
<dd><p>Score for users and items, after resolivng them and limiting to known
users and items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>users</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><em>Tensor</em></a>)</p></li>
<li><p><strong>items</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><em>Tensor</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFScorerBase.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFScorerBase.to" title="Link to this definition">#</a></dt>
<dd><p>Move the model to a different device.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFExplicitConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenskit.flexmf.</span></span><span class="sig-name descname"><span class="pre">FlexMFExplicitConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'L2'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFExplicitConfig" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenskit.flexmf.FlexMFConfigBase" title="lenskit.flexmf._base.FlexMFConfigBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlexMFConfigBase</span></code></a></p>
<p>Configuration for <a class="reference internal" href="#lenskit.flexmf.FlexMFExplicitScorer" title="lenskit.flexmf.FlexMFExplicitScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlexMFExplicitScorer</span></code></a>.  This class overrides
certain base class defaults for better explicit-feedback performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Stability<span class="colon">:</span></dt>
<dd class="field-odd"><p>Experimental</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>embedding_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>regularization</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>reg_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'AdamW'</em><em>, </em><em>'L2'</em><em>] </em><em>| </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFExplicitConfig.reg_method">
<span class="sig-name descname"><span class="pre">reg_method</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'AdamW'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'L2'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'L2'</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFExplicitConfig.reg_method" title="Link to this definition">#</a></dt>
<dd><p>The regularization method to use.</p>
<p>With the default AdamW regularization, training will use the
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.AdamW.html#torch.optim.AdamW" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">AdamW</span></code></a> optimizer with weight decay. With L2
regularization, training will use sparse gradients and the
<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.SparseAdam.html#torch.optim.SparseAdam" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.SparseAdam</span></code></a> optimizer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The explicit-feedback model defaults this setting to <code class="docutils literal notranslate"><span class="pre">&quot;L2&quot;</span></code>.</p>
</div>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">None</span></code></dt><dd><p>Use no regularization.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;L2&quot;</span></code></dt><dd><p>Use L2 regularization on the parameters used in each training batch. The
strength is applied to the _mean_ norms in a batch, so that the
regularization term scale is not dependent on the batch size.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;AdamW&quot;</span></code></dt><dd><p>Use <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.AdamW.html#torch.optim.AdamW" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.AdamW</span></code></a> with the specified regularization
strength.  This configuration does <em>not</em> use sparse gradients, but
training time is often comparable.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Regularization values do not necessarily have the same range or meaning
for the different regularization methods.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFExplicitConfig.regularization">
<span class="sig-name descname"><span class="pre">regularization</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.1</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFExplicitConfig.regularization" title="Link to this definition">#</a></dt>
<dd><p>The regularization strength.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The explicit-feedback model uses a different default strength.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFExplicitScorer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenskit.flexmf.</span></span><span class="sig-name descname"><span class="pre">FlexMFExplicitScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFExplicitScorer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenskit.flexmf.FlexMFScorerBase" title="lenskit.flexmf._base.FlexMFScorerBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlexMFScorerBase</span></code></a></p>
<p>Explicit-feedback rating prediction with FlexMF.  This realizes a biased
matrix factorization model (similar to <code class="xref py py-class docutils literal notranslate"><span class="pre">lenskit.als.BiasedMF</span></code>)
trained with PyTorch.</p>
<dl class="field-list simple">
<dt class="field-odd">Stability<span class="colon">:</span></dt>
<dd class="field-odd"><p>Experimental</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#lenskit.flexmf.FlexMFExplicitConfig" title="lenskit.flexmf._explicit.FlexMFExplicitConfig"><em>FlexMFExplicitConfig</em></a>)</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFExplicitScorer.create_trainer">
<span class="sig-name descname"><span class="pre">create_trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFExplicitScorer.create_trainer" title="Link to this definition">#</a></dt>
<dd><p>Create a model trainer to train this model.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFExplicitScorer.score_items">
<span class="sig-name descname"><span class="pre">score_items</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">users</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">items</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFExplicitScorer.score_items" title="Link to this definition">#</a></dt>
<dd><p>Score for users and items, after resolivng them and limiting to known
users and items.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>users</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><em>Tensor</em></a>)</p></li>
<li><p><strong>items</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><em>Tensor</em></a>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" rel="noreferrer" target="_blank" title="(in PyTorch v2.8)"><em>Tensor</em></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitConfig">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenskit.flexmf.</span></span><span class="sig-name descname"><span class="pre">FlexMFImplicitConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">regularization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reg_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'AdamW'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logistic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">negative_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positive_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitConfig" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenskit.flexmf.FlexMFConfigBase" title="lenskit.flexmf._base.FlexMFConfigBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlexMFConfigBase</span></code></a></p>
<p>Configuration for <a class="reference internal" href="#lenskit.flexmf.FlexMFImplicitScorer" title="lenskit.flexmf.FlexMFImplicitScorer"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlexMFImplicitScorer</span></code></a>.  It inherits base model
options from <a class="reference internal" href="#lenskit.flexmf.FlexMFConfigBase" title="lenskit.flexmf.FlexMFConfigBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlexMFConfigBase</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Stability<span class="colon">:</span></dt>
<dd class="field-odd"><p>Experimental</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>embedding_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>regularization</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>reg_method</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'AdamW'</em><em>, </em><em>'L2'</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>loss</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'logistic'</em><em>, </em><em>'pairwise'</em><em>, </em><em>'warp'</em><em>]</em>)</p></li>
<li><p><strong>negative_strategy</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>Literal</em></a><em>[</em><em>'uniform'</em><em>, </em><em>'popular'</em><em>, </em><em>'misranked'</em><em>] </em><em>| </em><em>None</em>)</p></li>
<li><p><strong>negative_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>int</em></a><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>positive_weight</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>Annotated</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>float</em></a><em>, </em><em>Gt</em><em>(</em><em>gt=0</em><em>)</em><em>]</em>)</p></li>
<li><p><strong>user_bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>bool</em></a><em> | </em><em>None</em>)</p></li>
<li><p><strong>item_bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" rel="noreferrer" target="_blank" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitConfig.item_bias">
<span class="sig-name descname"><span class="pre">item_bias</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">bool</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">True</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitConfig.item_bias" title="Link to this definition">#</a></dt>
<dd><p>Whether to learn an item bias term.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitConfig.loss">
<span class="sig-name descname"><span class="pre">loss</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'logistic'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pairwise'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'warp'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'logistic'</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitConfig.loss" title="Link to this definition">#</a></dt>
<dd><p>The loss to use for model training.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitConfig.negative_count">
<span class="sig-name descname"><span class="pre">negative_count</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">Annotated</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Gt</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">gt</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitConfig.negative_count" title="Link to this definition">#</a></dt>
<dd><p>The number of negative items to sample for each positive item in the
training data.  With BPR loss, the positive item is compared to each
negative item; with logistic loss, the positive item is treated once per
learning round, so this setting effectively makes the model learn on _n_
negatives per positive, rather than giving positive and negative examples
equal weight.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitConfig.negative_strategy">
<span class="sig-name descname"><span class="pre">negative_strategy</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'uniform'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'popular'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'misranked'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitConfig.negative_strategy" title="Link to this definition">#</a></dt>
<dd><p>The negative sampling strategy.  The default is <code class="docutils literal notranslate"><span class="pre">&quot;misranked&quot;</span></code> for WARP
loss and <code class="docutils literal notranslate"><span class="pre">&quot;uniform&quot;</span></code> for other losses.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitConfig.positive_weight">
<span class="sig-name descname"><span class="pre">positive_weight</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Annotated" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">Annotated</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">float</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Gt</span><span class="p"><span class="pre">(</span></span><span class="n"><span class="pre">gt</span></span><span class="o"><span class="pre">=</span></span><span class="m"><span class="pre">0</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1.0</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitConfig.positive_weight" title="Link to this definition">#</a></dt>
<dd><p>A weighting multiplier to apply to the positive item’s loss, to adjust the
relative importance of positive and negative classifications.  Only applies
to logistic loss.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitConfig.user_bias">
<span class="sig-name descname"><span class="pre">user_bias</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">bool</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" rel="noreferrer" target="_blank" title="(in Python v3.13)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitConfig.user_bias" title="Link to this definition">#</a></dt>
<dd><p>Whether to learn a user bias term.  If unspecified, the default depends on
the loss function (<code class="docutils literal notranslate"><span class="pre">False</span></code> for pairwise and <code class="docutils literal notranslate"><span class="pre">True</span></code> for logistic).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitScorer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lenskit.flexmf.</span></span><span class="sig-name descname"><span class="pre">FlexMFImplicitScorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitScorer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lenskit.flexmf.FlexMFScorerBase" title="lenskit.flexmf._base.FlexMFScorerBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">FlexMFScorerBase</span></code></a></p>
<p>Implicit-feedback rating prediction with FlexMF.  This is capable of
realizing multiple models, including:</p>
<ul class="simple">
<li><p>BPR-MF (Bayesian personalized ranking) <span id="id1">[<a class="reference internal" href="../references.html#id4" title="Steffen Rendle, Christoph Freudenthaler, Zeno Gantner, and Lars Schmidt-Thieme. BPR: Bayesian personalized ranking from implicit feedback. In UAI '09, 452–461. Arlington, Virginia, United States, 2009. AUAI Press. URL: http://dl.acm.org/citation.cfm?id=1795114.1795167 (visited on 2015-10-16).">RFGSchmidtThieme09</a>]</span> (with <code class="docutils literal notranslate"><span class="pre">&quot;pairwise&quot;</span></code> loss)</p></li>
<li><p>Logistic matrix factorization <span id="id2">[<a class="reference internal" href="../references.html#id36" title="Christopher C Johnson. Logistic matrix factorization for implicit feedback data. Adv. Neural Inf. Process. Syst., 2014. URL: http://web.stanford.edu/~rezab/nips2014workshop/submits/logmat.pdf.">Joh14</a>]</span> (with <code class="docutils literal notranslate"><span class="pre">&quot;logistic&quot;</span></code> loss)</p></li>
</ul>
<p>All use configurable negative sampling, including the sampling approach from WARP.</p>
<dl class="field-list simple">
<dt class="field-odd">Stability<span class="colon">:</span></dt>
<dd class="field-odd"><p>Experimental</p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#lenskit.flexmf.FlexMFImplicitConfig" title="lenskit.flexmf._implicit.FlexMFImplicitConfig"><em>FlexMFImplicitConfig</em></a>)</p></li>
<li><p><strong>kwargs</strong> (<em>Any</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lenskit.flexmf.FlexMFImplicitScorer.create_trainer">
<span class="sig-name descname"><span class="pre">create_trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#lenskit.flexmf.FlexMFImplicitScorer.create_trainer" title="Link to this definition">#</a></dt>
<dd><p>Create a model trainer to train this model.</p>
</dd></dl>

</dd></dl>

</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="lenskit.als.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">lenskit.als</p>
      </div>
    </a>
    <a class="right-next"
       href="lenskit.sklearn.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">lenskit.sklearn</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFConfigBase"><code class="docutils literal notranslate"><span class="pre">FlexMFConfigBase</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFConfigBase.batch_size"><code class="docutils literal notranslate"><span class="pre">FlexMFConfigBase.batch_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFConfigBase.embedding_size"><code class="docutils literal notranslate"><span class="pre">FlexMFConfigBase.embedding_size</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFConfigBase.epochs"><code class="docutils literal notranslate"><span class="pre">FlexMFConfigBase.epochs</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFConfigBase.learning_rate"><code class="docutils literal notranslate"><span class="pre">FlexMFConfigBase.learning_rate</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFConfigBase.reg_method"><code class="docutils literal notranslate"><span class="pre">FlexMFConfigBase.reg_method</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFConfigBase.regularization"><code class="docutils literal notranslate"><span class="pre">FlexMFConfigBase.regularization</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFScorerBase"><code class="docutils literal notranslate"><span class="pre">FlexMFScorerBase</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFScorerBase.score_items"><code class="docutils literal notranslate"><span class="pre">FlexMFScorerBase.score_items()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFScorerBase.to"><code class="docutils literal notranslate"><span class="pre">FlexMFScorerBase.to()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFExplicitConfig"><code class="docutils literal notranslate"><span class="pre">FlexMFExplicitConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFExplicitConfig.reg_method"><code class="docutils literal notranslate"><span class="pre">FlexMFExplicitConfig.reg_method</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFExplicitConfig.regularization"><code class="docutils literal notranslate"><span class="pre">FlexMFExplicitConfig.regularization</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFExplicitScorer"><code class="docutils literal notranslate"><span class="pre">FlexMFExplicitScorer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFExplicitScorer.create_trainer"><code class="docutils literal notranslate"><span class="pre">FlexMFExplicitScorer.create_trainer()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFExplicitScorer.score_items"><code class="docutils literal notranslate"><span class="pre">FlexMFExplicitScorer.score_items()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitConfig"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitConfig</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitConfig.item_bias"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitConfig.item_bias</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitConfig.loss"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitConfig.loss</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitConfig.negative_count"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitConfig.negative_count</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitConfig.negative_strategy"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitConfig.negative_strategy</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitConfig.positive_weight"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitConfig.positive_weight</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitConfig.user_bias"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitConfig.user_bias</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitScorer"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitScorer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lenskit.flexmf.FlexMFImplicitScorer.create_trainer"><code class="docutils literal notranslate"><span class="pre">FlexMFImplicitScorer.create_trainer()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/api/lenskit.flexmf.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2018–2025 Drexel University, Boise State University, and collaborators.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">LensKit version 2025.3.0a4.dev355+gf6e086e0.</div>
      
        <div class="footer-item"><p>
    This material is partially based upon work supported by the National Science Foundation under
    Grant Nos. <a href="https://md.ekstrandom.net/research/career" target="_blank">17-51278</a> and
    24-15042. Any opinions, findings, and conclusions or recommendations expressed in this material
    are those of the author(s) and do not necessarily reflect the views of the
    National Science Foundation, Drexel University, or Boise State University.</p>
</p></div>
      
        <div class="footer-item"><script data-goatcounter="https://lenskit.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>